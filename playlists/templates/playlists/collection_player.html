{% extends "base.html" %}
{% load static %}

{% block title %}{{ collection.name }} - Relaxify{% endblock %}

{% block extra_css %}
    <link href="{% static 'css/collection_player.css' %}" rel="stylesheet">
{% endblock %}

{% block extra_js %}
    <script src="{% static 'js/offline-storage.js' %}"></script>
    <script src="{% static 'js/collection_player.js' %}"></script>
{% endblock %}

{% block content %}
    <div class="player-container">
        {% include 'playlists/collection_player_content.html' with is_modal=False %}
    </div>

    <script>
        // Initialize collection player with data from Django
        window.collectionData = {
            id: {{ collection.id }},
            name: '{{ collection.name|escapejs }}',
            platform: '{{ collection.platform }}',
            playlist_count: {{ collection.playlist_count }}
        };

        // Initialize tracks data
        window.tracks = [
            {% if tracks %}
            {% for track in tracks %}
            {
                id: {{ track.id }},
                youtube_id: '{{ track.youtube_id }}',
                title: '{{ track.title|escapejs }}',
                artist: '{{ track.artist|default:"Unknown Artist"|escapejs }}',
                duration: '{{ track.duration|default:"--:--" }}',
                views: {{ track.view_count|default:0 }},
                thumbnail: '{{ track.thumbnail_url|default:"" }}'
            }{% if not forloop.last %},{% endif %}
            {% endfor %}
            {% endif %}
        ];
    </script>
    
    <script>
        // Initialize the collection player
        document.addEventListener('DOMContentLoaded', function() {
            initCollectionPlayer(window.collectionData, window.tracks, false);
        });

        // Additional functions specific to full-page collection player
        function playTrack(index) {
            playCollectionTrack(index, '');
        }
    </script>
{% endblock %}